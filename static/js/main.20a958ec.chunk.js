(this.webpackJsonpnekidaem=this.webpackJsonpnekidaem||[]).push([[0],{31:function(e,t,n){},38:function(e,t,n){},39:function(e,t,n){},40:function(e,t,n){},41:function(e,t,n){},42:function(e,t,n){},43:function(e,t,n){},44:function(e,t,n){},45:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n.n(c),r=n(11),s=n.n(r),o=n(10),i=(n(31),n(25)),l=n(9),u=n(3),d=Object(c.createContext)(),j=n(7),b=n(26),h=n(1),m=["component"],f=function(e){var t=e.component,n=Object(b.a)(e,m),a=Object(c.useContext)(d);return Object(h.jsx)(u.b,{children:function(){return a.loggedIn?Object(h.jsx)(t,Object(j.a)({},n)):Object(h.jsx)(u.a,{to:"./sign-in"})}})};n(38);var O=function(){var e=Object(c.useContext)(d);return Object(h.jsx)("header",{className:"header",children:Object(h.jsx)("button",{className:"header__logout",onClick:e.handleClickLogout,children:"\u0412\u044b\u0439\u0442\u0438"})})},p=n(13);n(39);var _=function(e){var t=e.itemData,n=e.columnId,a=e.cardId,r=Object(c.useContext)(d),s=t.id,o=t.text,i=function(){return r.handleDeleteCard(s)};return Object(h.jsx)(p.b,{draggableId:"".concat(n+"-"+a),index:a,children:function(e){return Object(h.jsxs)("div",Object(j.a)(Object(j.a)(Object(j.a)({className:"card",ref:e.innerRef},e.draggableProps),e.dragHandleProps),{},{children:[Object(h.jsx)("button",{className:"card__button-delete",onClick:i,children:"+"}),Object(h.jsxs)("div",{className:"card__id-block",children:[Object(h.jsx)("h3",{className:"card__id card__id_name",children:"id:"}),Object(h.jsx)("p",{className:"card__id card__id_number",children:s})]}),Object(h.jsx)("p",{className:"card__text",children:o})]}))}})};n(40);var g=function(e){var t=e.title,n=e.columnId,a=Object(c.useContext)(d),r=function(){var e="column__title-block_";switch(n){case 0:return e+"on-hold";case 1:return e+"in-progress";case 2:return e+"needs-review";case 3:return e+"approved";default:return""}},s=Object(c.useState)([]),o=Object(l.a)(s,2),i=o[0],u=o[1],b=Object(c.useState)(!1),m=Object(l.a)(b,2),f=m[0],O=m[1],g=Object(c.useState)(""),x=Object(l.a)(g,2),v=x[0],C=x[1],N=function(){return O(!0)},k=function(){O(!1),C("")},y=function(e){return C(e.target.value)},S=function(e){e.preventDefault(),a.handleAddCard(v,String(n)),k()};return Object(c.useEffect)((function(){if(a.cardsList.length>0){var e=a.cardsList.filter((function(e){return e.row==="".concat(n)}));u(e)}}),[n,a.cardsList,a.loggedIn]),Object(h.jsx)(p.c,{droppableId:"".concat(n),children:function(e){return Object(h.jsxs)("div",Object(j.a)(Object(j.a)({className:"column",ref:e.innerRef},e.droppableProps),{},{children:[Object(h.jsx)("div",{className:"column__title-block ".concat(r()),children:Object(h.jsxs)("h2",{className:"column__title",children:[t," (",i.length||0,")"]})}),Object(h.jsxs)("div",{className:"column__cards-list",children:[i.map((function(e,t){return Object(h.jsx)(_,{itemData:e,columnId:n,cardId:t},e.id)})),e.placeholder]}),f?Object(h.jsxs)("form",{className:"column__form",onSubmit:S,children:[Object(h.jsx)("textarea",{className:"column__textarea",value:v,onChange:y}),Object(h.jsx)("button",{type:"submit",disabled:!v,className:"column__button column__button_submit",children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0443"}),Object(h.jsx)("button",{type:"button",className:"column__button column__button_close",onClick:k,children:"+"})]}):Object(h.jsx)("button",{type:"button",className:"column__button column__button_add",onClick:N,children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0443"})]}))}})};n(41);var x=function(){var e=Object(c.useContext)(d);return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(O,{}),Object(h.jsx)("main",{className:"main",children:Object(h.jsx)(p.a,{onDragEnd:function(e){if(e.destination){var t=e.source,n=e.destination,c=t.droppableId,a=n.droppableId,r=t.index,s=n.index;t.droppableId===n.droppableId&&t.index===n.index||(console.log("----------------"),console.log("\u041a\u043e\u043b\u043e\u043d\u043a\u0430: ".concat(c," => ").concat(a)),console.log("\u041f\u043e\u0437\u0438\u0446\u0438\u044f: ".concat(r," => ").concat(s)))}},children:e.titleColumns.map((function(e,t){return Object(h.jsx)(g,{title:e,columnId:t},t)}))})})]})},v=n(15);function C(){var e=Object(c.useState)({}),t=Object(l.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)({}),s=Object(l.a)(r,2),o=s[0],i=s[1],u=Object(c.useState)(!1),d=Object(l.a)(u,2),b=d[0],h=d[1],m=Object(c.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];a(e),i(t),h(n)}),[a,i,h]);return{values:n,handleChange:function(e){var t=e.target,c=t.name,r=t.value;a(Object(j.a)(Object(j.a)({},n),{},Object(v.a)({},c,r))),i(Object(j.a)(Object(j.a)({},o),{},Object(v.a)({},c,t.validationMessage))),h(t.closest("form").checkValidity())},errors:o,isValid:b,resetForm:m,setValues:a}}n(42);var N=function(){var e=Object(c.useContext)(d),t=C(),n=t.values,a=t.errors,r=t.isValid,s=t.handleChange;return Object(h.jsxs)("form",{className:"form",onSubmit:function(t){t.preventDefault(),e.handleClickLogin(n)},children:[Object(h.jsx)("h2",{className:"form__title",children:"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f"}),Object(h.jsxs)("label",{className:"form__label",children:["Username",Object(h.jsx)("input",{type:"text",name:"username",value:n.username||"",onChange:s,minLength:1,maxLength:150,required:!0,className:"form__input"})]}),a.username?Object(h.jsx)("span",{className:"form__error",children:a.username}):"",Object(h.jsxs)("label",{className:"form__label",children:["Password",Object(h.jsx)("input",{type:"password",name:"password",value:n.password||"",onChange:s,minLength:1,maxLength:128,required:!0,className:"form__input"})]}),a.password?Object(h.jsx)("span",{className:"form__error",children:a.password}):"",Object(h.jsx)("button",{type:"submit",className:"form__submit",disabled:!r,children:"\u0412\u043e\u0439\u0442\u0438"}),Object(h.jsx)(o.b,{to:"/sign-up",className:"form__link",children:"\u041d\u0435\u0442 \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430? \u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u0443\u0439\u0442\u0435\u0441\u044c"})]})};n(43);var k=function(){var e=Object(c.useContext)(d),t=C(),n=t.values,a=t.errors,r=t.isValid,s=t.handleChange;return Object(h.jsxs)("form",{className:"form",onSubmit:function(t){t.preventDefault(),e.handleClickRegistr(n)},children:[Object(h.jsx)("h2",{className:"form__title",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(h.jsxs)("label",{className:"form__label",children:["Username",Object(h.jsx)("input",{type:"text",name:"username",value:n.username||"",onChange:s,minLength:1,maxLength:150,required:!0,className:"form__input"})]}),a.username?Object(h.jsx)("span",{className:"form__error",children:a.username}):"",Object(h.jsxs)("label",{className:"form__label",children:["Email",Object(h.jsx)("input",{type:"email",name:"email",value:n.email||"",onChange:s,maxLength:254,className:"form__input"})]}),a.email?Object(h.jsx)("span",{className:"form__error",children:a.email}):"",Object(h.jsxs)("label",{className:"form__label",children:["Password",Object(h.jsx)("input",{type:"password",name:"password",value:n.password||"",onChange:s,minLength:1,maxLength:128,required:!0,className:"form__input"})]}),a.password?Object(h.jsx)("span",{className:"form__error",children:a.password}):"",Object(h.jsx)("button",{type:"submit",className:"form__submit",disabled:!r,children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"}),Object(h.jsx)(o.b,{to:"/sign-in",className:"form__link",children:"\u0415\u0441\u0442\u044c \u0430\u043a\u043a\u0430\u0443\u043d\u0442? \u0410\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})]})},y=(n(44),n(23)),S=n(24),w=new(function(){function e(t){var n=t.baseUrl,c=t.headers;Object(y.a)(this,e),this._baseUrl=n,this._headers=c}return Object(S.a)(e,[{key:"_checkResponse",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430 ".concat(e.status))}},{key:"createUser",value:function(e){return fetch("".concat(this._baseUrl,"/users/create/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(this._checkResponse)}},{key:"loginUser",value:function(e){return fetch("".concat(this._baseUrl,"/users/login/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(this._checkResponse)}},{key:"refreshToken",value:function(e){return fetch("".concat(this._baseUrl,"/users/refresh_token/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e})}).then(this._checkResponse)}},{key:"getCards",value:function(e){return fetch("".concat(this._baseUrl,"/cards/"),{method:"GET",headers:{Authorization:"JWT ".concat(e),"Content-Type":"application/json"}}).then(this._checkResponse)}},{key:"createCard",value:function(e,t,n){return fetch("".concat(this._baseUrl,"/cards/"),{method:"POST",headers:{Authorization:"JWT ".concat(n),"Content-Type":"application/json"},body:JSON.stringify({text:e,row:t})}).then(this._checkResponse)}},{key:"deleteCard",value:function(e,t){return fetch("".concat(this._baseUrl,"/cards/").concat(e,"/"),{method:"DELETE",headers:{Authorization:"JWT ".concat(t),"Content-Type":"application/json"}}).then((function(e){if(!e.ok)return Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430 ".concat(e.status))}))}}]),e}())({baseUrl:"https://trello.backend.tests.nekidaem.ru/api/v1"});var I=function(){var e=Object(c.useState)(!1),t=Object(l.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)([]),s=Object(l.a)(r,2),o=s[0],j=s[1],b=Object(u.g)(),m=function(e){localStorage.setItem("jwt",e.token),a(!0),b.push("/"),w.getCards(e.token).then((function(e){return j(e)})).catch((function(e){return console.log(e)}))};return Object(c.useEffect)((function(){var e=localStorage.getItem("jwt");e&&w.refreshToken(e).then((function(e){return m(e)})).catch((function(e){return console.log(e)}))}),[b,n]),Object(h.jsx)(d.Provider,{value:{loggedIn:n,titleColumns:["On hold","In progress","Needs review","Approved"],cardsList:o,setCardsList:j,handleClickLogin:function(e){return a(!0),w.loginUser(e).then((function(e){return m(e)})).catch((function(e){return console.log(e)}))},handleClickRegistr:function(e){return w.createUser(e).then((function(e){localStorage.setItem("jwt",e.token),a(!0),b.push("/")})).catch((function(e){return console.log(e)}))},handleClickLogout:function(){localStorage.removeItem("jwt"),b.push("/sign-in")},handleAddCard:function(e,t){var n=localStorage.getItem("jwt");return w.createCard(e,t,n).then((function(e){return j([].concat(Object(i.a)(o),[e]))})).catch((function(e){return console.log(e)}))},handleDeleteCard:function(e){var t=localStorage.getItem("jwt");return w.deleteCard(e,t).then((function(){return j(o.filter((function(t){return t.id!==e})))})).catch((function(e){return console.log(e)}))}},children:Object(h.jsxs)(u.d,{children:[Object(h.jsx)(u.b,{path:"/sign-in",children:Object(h.jsx)(N,{})}),Object(h.jsx)(u.b,{path:"/sign-up",children:Object(h.jsx)(k,{})}),Object(h.jsx)(f,{exact:!0,path:"/",component:x})]})})},L=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,46)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,s=t.getTTFB;n(e),c(e),a(e),r(e),s(e)}))};s.a.render(Object(h.jsx)(a.a.StrictMode,{children:Object(h.jsx)(o.a,{children:Object(h.jsx)(I,{})})}),document.getElementById("root")),L()}},[[45,1,2]]]);
//# sourceMappingURL=main.20a958ec.chunk.js.map